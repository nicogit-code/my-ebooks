{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _defineProperty from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useContext}from'react';import axios from'axios';import UserContext from'./UserContext';import{Switch,Redirect}from'react-router-dom';import styles from'./Login.module.css';var errorMessages={'username':'Please type username','password':'Please type password'};export default function Login(){var _useState=useState({'username':'','password':''}),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState({'username':'','password':''}),_useState4=_slicedToArray(_useState3,2),formError=_useState4[0],setFormError=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),globalErrorMessage=_useState6[0],setGlobalError=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSuccessfull=_useState8[0],setSuccessfull=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),isFilled=_useState10[0],setFilled=_useState10[1];// const [shouldValidate, setShouldValidate] = useState(false);\nvar _useContext=useContext(UserContext),setUser=_useContext.setUser;function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var isInvalid,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();setGlobalError('');setSuccessfull(false);isInvalid=validateData();if(isInvalid){_context.next=19;break;}setFilled(false);// let res;\n_context.prev=6;_context.next=9;return axios.post('/login',formData);case 9:res=_context.sent;setUser(res.data);console.log(res);localStorage.setItem('user',JSON.stringify(res.data));setSuccessfull(true);_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](6);setGlobalError(_context.t0.response.data.message);case 19:case\"end\":return _context.stop();}}},_callee,null,[[6,16]]);}));return _handleSubmit.apply(this,arguments);}function validateData(){var inputs=['username','password'];var newError=_objectSpread({},formError);var isInvalid=false;for(var _i=0,_inputs=inputs;_i<_inputs.length;_i++){var input=_inputs[_i];if(!formData[input]){newError[input]=errorMessages[input];isInvalid=true;}}setFormError(newError);return isInvalid;}function handleInputChange(e){setFilled(true);setFormData(_objectSpread({},formData,_defineProperty({},e.currentTarget.id,e.currentTarget.value)));var newError=_objectSpread({},formError,_defineProperty({},e.currentTarget.id,''));if(e.currentTarget.id==='password'||e.currentTarget.id==='retype-password'){newError['different-passwords']='';}setFormError(newError);}return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(\"div\",{className:styles.formBody},/*#__PURE__*/React.createElement(\"h1\",null,\"Login\"),globalErrorMessage?/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-danger\",role:\"alert\"},globalErrorMessage):null,isSuccessfull?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-success\",role:\"alert\"},\"Te-ai autentificat cu succes!\"),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Redirect,{from:\"/login\",to:\"/profile/\"}))):null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:styles.formGroup},/*#__PURE__*/React.createElement(\"input\",{onChange:handleInputChange,value:formData.username,type:\"text\",className:'form-control'+(formError.username?' is-invalid':''),id:\"username\",placeholder:\"Enter username\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"invalid-feedback\"},formError.username),/*#__PURE__*/React.createElement(\"input\",{onChange:handleInputChange,value:formData.password,type:\"password\",className:'form-control'+(formError.password?' is-invalid':''),id:\"password\",placeholder:\"Enter password\"}),/*#__PURE__*/React.createElement(\"div\",{className:\"invalid-feedback\"},formError.password),/*#__PURE__*/React.createElement(\"ul\",{className:styles.social},/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://www.facebook.com\",className:styles.socialBtn},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-facebook fa-fw\"}))),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://twitter.com/login/error?username_or_email=nicki_mamu%40yahoo.com&redirect_after_login=%2F\",className:styles.socialBtn},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-twitter fa-fw\"}))),/*#__PURE__*/React.createElement(\"li\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://myaccount.google.com/profile\",className:styles.socialBtn},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-google fa-fw\"})))),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:styles.button,disabled:!isFilled},\"Login\")))));}","map":{"version":3,"sources":["D:/ebooks-react-booksy/src/components/auth/Login.js"],"names":["React","useState","useContext","axios","UserContext","Switch","Redirect","styles","errorMessages","Login","formData","setFormData","formError","setFormError","globalErrorMessage","setGlobalError","isSuccessfull","setSuccessfull","isFilled","setFilled","setUser","handleSubmit","e","preventDefault","isInvalid","validateData","post","res","data","console","log","localStorage","setItem","JSON","stringify","response","message","inputs","newError","input","handleInputChange","currentTarget","id","value","formBody","formGroup","username","password","social","socialBtn","button"],"mappings":"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","sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport axios from 'axios';\r\nimport UserContext from './UserContext';\r\nimport { Switch, Redirect } from 'react-router-dom';\r\n\r\nimport styles from './Login.module.css';\r\n\r\n\r\nconst errorMessages = {\r\n    'username':'Please type username',\r\n    'password':'Please type password',\r\n};\r\n\r\nexport default function Login() {\r\n\r\n    const [formData, setFormData] = useState({\r\n        'username':'',\r\n        'password':'',\r\n    });\r\n\r\n    const [formError, setFormError] = useState({\r\n        'username':'',\r\n        'password':'',\r\n\r\n    });\r\n\r\n    const [globalErrorMessage, setGlobalError] = useState('');\r\n    const[isSuccessfull, setSuccessfull] = useState(false);\r\n    const[isFilled, setFilled] = useState(true);\r\n    // const [shouldValidate, setShouldValidate] = useState(false);\r\n    const { setUser } = useContext(UserContext);\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault(); \r\n\r\n        setGlobalError('');\r\n        setSuccessfull(false);\r\n        \r\n        const isInvalid = validateData();\r\n\r\n        if(!isInvalid) {\r\n            setFilled(false);\r\n            // let res;\r\n            try {\r\n                // const res = await axios.post('http://localhost:3001/login', formData);\r\n                const res = await axios.post('/login', formData);\r\n                setUser(res.data);\r\n                console.log(res);\r\n                localStorage.setItem('user', JSON.stringify(res.data));\r\n                setSuccessfull(true);\r\n            } catch(e) {\r\n                setGlobalError(e.response.data.message);\r\n            }\r\n        }\r\n    }\r\n\r\n    function validateData() {\r\n        const inputs = ['username', 'password'];\r\n        const newError = { ...formError };\r\n        let isInvalid = false;\r\n\r\n        for(const input of inputs) {\r\n            if(!formData[input]) {\r\n                newError[input] = errorMessages[input];\r\n                isInvalid = true;\r\n            }\r\n        }\r\n\r\n        setFormError(newError);\r\n        return isInvalid;\r\n    }\r\n\r\n    function handleInputChange(e) {\r\n\r\n        setFilled(true);\r\n\r\n        setFormData({\r\n            ...formData,\r\n            [e.currentTarget.id]: e.currentTarget.value\r\n        });\r\n\r\n        const newError = { ...formError, [e.currentTarget.id]:'',};\r\n        if(e.currentTarget.id === 'password' || e.currentTarget.id === 'retype-password') {\r\n            newError['different-passwords'] = '';\r\n        }\r\n\r\n        setFormError(newError)\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <div className={ styles.formBody }>\r\n                <h1>Login</h1>\r\n\r\n                {(globalErrorMessage ?\r\n                    <div className=\"alert alert-danger\" role=\"alert\">\r\n                        { globalErrorMessage }\r\n                    </div>\r\n                : null)}\r\n\r\n                {(isSuccessfull ?\r\n                <>\r\n                    <div className=\"alert alert-success\" role=\"alert\">\r\n                        Te-ai autentificat cu succes!\r\n                    </div>\r\n                    <Switch>\r\n                        <Redirect from='/login' to ='/profile/'/>\r\n                    </Switch>\r\n                    \r\n                </>\r\n                : null)}\r\n                <form onSubmit={ handleSubmit }>\r\n\r\n                    <div className={ styles.formGroup}>\r\n                        {/* <label htmlFor=\"username\"></label> */}\r\n                        <input \r\n                            onChange={ handleInputChange } \r\n                            value={ formData.username } \r\n                            type=\"text\" \r\n                            className={'form-control' + (formError.username ? ' is-invalid' : '')} \r\n                            id=\"username\" \r\n                            placeholder=\"Enter username\"\r\n                        />\r\n                        <div className=\"invalid-feedback\">\r\n                            { formError.username }\r\n                        </div>\r\n\r\n                        <input \r\n                            onChange={ handleInputChange } \r\n                            value={ formData.password } \r\n                            type=\"password\" \r\n                            className={'form-control' + (formError.password ? ' is-invalid' : '')}  \r\n                            id=\"password\"\r\n                            placeholder=\"Enter password\"\r\n                        />\r\n                        <div className=\"invalid-feedback\">\r\n                            { formError.password }\r\n                        </div>\r\n\r\n                        <ul className={ styles.social }>\r\n                            <li>\r\n                                <a href=\"https://www.facebook.com\" className={ styles.socialBtn }>\r\n                                    <i className=\"fa fa-facebook fa-fw\"></i>\r\n                                </a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://twitter.com/login/error?username_or_email=nicki_mamu%40yahoo.com&redirect_after_login=%2F\" className={ styles.socialBtn }>\r\n                                    <i className=\"fa fa-twitter fa-fw\"></i>\r\n                                </a>\r\n                            </li>\r\n                            <li>\r\n                                <a href=\"https://myaccount.google.com/profile\" className={ styles.socialBtn }>\r\n                                    <i className=\"fa fa-google fa-fw\"></i>\r\n                                </a>\r\n                            </li>\r\n                        </ul>\r\n                        <button type=\"submit\" className={ styles.button } disabled={ !isFilled }>Login</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        </div>\r\n        \r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}