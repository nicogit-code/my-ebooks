{"ast":null,"code":"var _jsxFileName = \"D:\\\\ebooks-react-booksy\\\\src\\\\components\\\\books\\\\AddBookReview.js\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, Redirect } from 'react-router-dom';\nimport axios from 'axios';\nimport UserContext from '../auth/UserContext';\nimport styles from './AddBookReview.module.css';\nexport default function AddReview() {\n  const {\n    bookId\n  } = useParams();\n  const [book, setBook] = useState(null);\n  const [redirect, setRedirect] = useState(false);\n  const [review, setReview] = useState({\n    body: '',\n    date: ''\n  });\n  const {\n    user\n  } = useContext(UserContext);\n  const [isSuccessfull, setSuccessfull] = useState(false);\n\n  async function getBookById(id) {\n    try {\n      const res = await axios('/books/' + id);\n      console.log(res);\n      setBook(res.data);\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n\n  async function handleSubmit(e) {\n    e.preventDefault();\n\n    try {\n      const res = await axios.post('/reviews/', { ...review,\n        user: user.username,\n        popularityId: Number(bookId)\n      });\n      setSuccessfull(true);\n      setTimeout(() => setRedirect(true), 2000);\n      console.log(res);\n    } catch (e) {\n      console.warn(e);\n    }\n  }\n\n  function handleInputChange(e) {\n    setReview({ ...review,\n      [e.currentTarget.id]: e.currentTarget.value\n    });\n  }\n\n  useEffect(() => {\n    getBookById(bookId);\n  }, [bookId]);\n\n  if (!book) {\n    return /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 16\n      }\n    }, \"Loading...\");\n  }\n\n  if (!user) {\n    return /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 12\n      }\n    }, \"Pentru a adauga un review, trebuie sa fii autentificat\");\n  }\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.formBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }, \"Ai citit-o? Scrie un review!\"), isSuccessfull ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert-success\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"alert\",\n    role: \"alert\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }\n  }, \"Review-ul tau a fost salvat.\"), redirect && /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 30\n    }\n  })) // <button type=\"submit\" className={ styles.button }>Inapoi</button>\n  : null, /*#__PURE__*/React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleInputChange,\n    value: review.body,\n    type: \"text\",\n    className: styles.formControl,\n    id: \"body\",\n    placeholder: \"Scrie p\\u0103rerea ta\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    onChange: handleInputChange,\n    value: review.date,\n    className: 'dateSelector',\n    id: \"date\",\n    placeholder: \"Selecteaz\\u0103 data\",\n    type: \"date\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    className: styles.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 25\n    }\n  }, \"Salveaz\\u0103\")))));\n}","map":{"version":3,"sources":["D:/ebooks-react-booksy/src/components/books/AddBookReview.js"],"names":["React","useState","useEffect","useContext","useParams","Redirect","axios","UserContext","styles","AddReview","bookId","book","setBook","redirect","setRedirect","review","setReview","body","date","user","isSuccessfull","setSuccessfull","getBookById","id","res","console","log","data","e","warn","handleSubmit","preventDefault","post","username","popularityId","Number","setTimeout","handleInputChange","currentTarget","value","formBody","formGroup","formControl","button"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { useParams, Redirect } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport UserContext from '../auth/UserContext';\r\n\r\nimport styles from './AddBookReview.module.css';\r\n\r\nexport default function AddReview() {\r\n    const { bookId } = useParams();\r\n    const [book, setBook] = useState(null);\r\n    \r\n    const [redirect, setRedirect] = useState(false);\r\n    const [review, setReview] = useState({\r\n        body: '',\r\n        date: ''\r\n    });\r\n    const { user } = useContext(UserContext);\r\n    const[isSuccessfull, setSuccessfull] = useState(false);\r\n\r\n\r\n    async function getBookById(id) {\r\n        try {\r\n            const res = await axios('/books/' + id);\r\n            console.log(res);\r\n            setBook(res.data);\r\n        } catch(e) {\r\n            console.warn(e);\r\n        }\r\n    }\r\n\r\n    async function handleSubmit(e) {\r\n        e.preventDefault();\r\n        try {\r\n\r\n            const res = await axios.post('/reviews/', {...review, user: user.username, popularityId: Number(bookId)});\r\n\r\n            setSuccessfull(true);\r\n            setTimeout(() => setRedirect(true), 2000);\r\n\r\n            console.log(res);\r\n        } catch(e) {\r\n            console.warn(e);\r\n        }\r\n    }\r\n\r\n    function handleInputChange(e) {\r\n        setReview({ ...review, [e.currentTarget.id]: e.currentTarget.value});\r\n    }\r\n    \r\n    useEffect(() => { \r\n        getBookById(bookId); \r\n    }, [bookId]);\r\n\r\n    if(!book) {\r\n        return <h2>Loading...</h2>;\r\n    }\r\n\r\n    if(!user) {\r\n    return <p>Pentru a adauga un review, trebuie sa fii autentificat</p>;\r\n    }\r\n    \r\n    return (\r\n        <div className={styles.formBody}>\r\n            <h2>Ai citit-o? Scrie un review!</h2>\r\n            {(isSuccessfull ?\r\n            <div className=\"alert-success\">\r\n                <div className=\"alert\" role=\"alert\">\r\n                    Review-ul tau a fost salvat.\r\n                </div>\r\n                {redirect && <Redirect to='/'/> }\r\n                \r\n            </div>\r\n                // <button type=\"submit\" className={ styles.button }>Inapoi</button>\r\n            : null)}\r\n\r\n\r\n\r\n            <form onSubmit={ handleSubmit }>\r\n                <div className={ styles.formGroup}>\r\n                    <input \r\n                        onChange={ handleInputChange }\r\n                        value={ review.body }\r\n                        type=\"text\" \r\n                        className={styles.formControl} \r\n                        id=\"body\" \r\n                        placeholder=\"Scrie părerea ta\"\r\n                    />\r\n                    <br/>\r\n                    <input \r\n                        onChange={ handleInputChange }\r\n                        value={ review.date }\r\n                        className={'dateSelector'} \r\n                        id=\"date\" \r\n                        placeholder=\"Selectează data\"\r\n                        type=\"date\"\r\n                    />\r\n                    <div>\r\n                        <button type=\"submit\" className={ styles.button }>Salvează</button>\r\n                    </div>\r\n                </div>\r\n            </form>\r\n            \r\n        </div>\r\n    )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}