{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{useParams,Link,Redirect}from'react-router-dom';import axios from'axios';import UserContext from'../auth/UserContext';import styles from'./BookDetails.module.css';import BookReviews from'./BookReviews';function BookDetails(){var _useParams=useParams(),bookId=_useParams.bookId;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),book=_useState2[0],setBook=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),redirect=_useState4[0],setRedirect=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),isSuccessfull=_useState6[0],setSuccessfull=_useState6[1];var _useContext=useContext(UserContext),user=_useContext.user;function getBookById(_x){return _getBookById.apply(this,arguments);}function _getBookById(){_getBookById=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios('/books/'+id);case 3:res=_context.sent;// console.log(res.data);\nsetBook(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.warn(_context.t0);case 10:case\"end\":return _context.stop();}}},_callee,null,[[0,7]]);}));return _getBookById.apply(this,arguments);}function handleAddToFavorites(){return _handleAddToFavorites.apply(this,arguments);}function _handleAddToFavorites(){_handleAddToFavorites=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post('/userLibrary',{userId:user.id,bookId:book.id});case 2:res=_context2.sent;setSuccessfull(true);setTimeout(function(){return setRedirect(true);},1000);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _handleAddToFavorites.apply(this,arguments);}useEffect(function(){getBookById(bookId);},[bookId]);if(book){return/*#__PURE__*/React.createElement(\"div\",{className:\"wrapper\"},/*#__PURE__*/React.createElement(\"div\",{className:styles.container},/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\"},/*#__PURE__*/React.createElement(\"h1\",null,book.title),/*#__PURE__*/React.createElement(\"h4\",null,\"Autor: \",book.author),/*#__PURE__*/React.createElement(\"p\",null,\"Categorie: \",book.genre),/*#__PURE__*/React.createElement(\"p\",null,\"ISBN: \",book.isbn),/*#__PURE__*/React.createElement(\"p\",null,\"Anul public\\u0103rii: \",book.publicationDate,\" \"),/*#__PURE__*/React.createElement(\"p\",null,\"Titlul original: \",book.originalTitle),/*#__PURE__*/React.createElement(\"p\",null,\"Limba original\\u0103: \",book.originalLanguage),/*#__PURE__*/React.createElement(\"p\",null,\"Descriere: \",book.description,\" \",/*#__PURE__*/React.createElement(\"a\",{href:book.readMore},\"Citeste mai mult\")),user?/*#__PURE__*/React.createElement(Link,{className:styles.button,to:book.download},\"Download\"):null,user?/*#__PURE__*/React.createElement(Link,{className:styles.button,to:\"/books/add/\"+book.id},\"Adaug\\u0103 review\"):null,user?/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Link,{className:styles.button,onClick:handleAddToFavorites},\"Adaug\\u0103 la favorite\"),isSuccessfull?/*#__PURE__*/React.createElement(\"div\",{className:\"alert alert-success\",role:\"alert\"},\"Modific\\u0103rile tale a fost salvate.\",redirect&&/*#__PURE__*/React.createElement(Redirect,{to:\"/profile\"})):null):null),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{className:styles.cardImg,src:book.cover,component:\"img\",alt:\"Book Cover\"})),/*#__PURE__*/React.createElement(\"div\",{className:styles.reviews},/*#__PURE__*/React.createElement(BookReviews,{key:book.id})))));}else{return/*#__PURE__*/React.createElement(\"h2\",null,\"Loading...\");}}export default BookDetails;","map":{"version":3,"sources":["D:/ebooks-react-booksy/src/components/books/BookDetails.js"],"names":["React","useEffect","useState","useContext","useParams","Link","Redirect","axios","UserContext","styles","BookReviews","BookDetails","bookId","book","setBook","redirect","setRedirect","isSuccessfull","setSuccessfull","user","getBookById","id","res","data","console","warn","handleAddToFavorites","post","userId","setTimeout","container","title","author","genre","isbn","publicationDate","originalTitle","originalLanguage","description","readMore","button","download","cardImg","cover","reviews"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { useParams, Link, Redirect } from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nimport UserContext from '../auth/UserContext';\r\nimport styles from './BookDetails.module.css';\r\n\r\nimport BookReviews from './BookReviews';\r\n\r\nfunction BookDetails() {\r\n    const { bookId } = useParams();\r\n    const [book, setBook] = useState(null);\r\n    const [redirect, setRedirect] = useState(false);\r\n    const [isSuccessfull, setSuccessfull] = useState(null);\r\n\r\n    const { user } = useContext(UserContext);\r\n\r\n    async function getBookById(id) {\r\n        try {\r\n            const res = await axios('/books/' + id);\r\n            // console.log(res.data);\r\n            setBook(res.data);\r\n        } catch(e) {\r\n            console.warn(e);\r\n        }\r\n    }\r\n\r\n    async function handleAddToFavorites() {\r\n        const res = await axios.post('/userLibrary', { userId: user.id, bookId: book.id});\r\n        setSuccessfull(true);\r\n        setTimeout(() => setRedirect(true), 1000);\r\n    }\r\n    \r\n    useEffect(() => { \r\n        getBookById(bookId); \r\n    }, [bookId]);\r\n\r\n    if(book) {\r\n        return (\r\n            <div className=\"wrapper\">\r\n            {/* {(isSuccessfull ?\r\n                <>\r\n                    <div className=\"alert alert-success\" role=\"alert\">\r\n                        Modificările tale a fost salvate. Mulțumim!\r\n                    </div>\r\n                    {redirect && <Redirect to='/profile'/> }\r\n                </>\r\n                : null)} */}\r\n                <div className={ styles.container }>\r\n                    <div className=\"row\">\r\n                        <div className=\"col-8\">\r\n                            <h1>{ book.title }</h1>\r\n                            <h4>Autor: { book.author }</h4>\r\n                            <p>Categorie: { book.genre }</p>\r\n                            <p>ISBN: { book.isbn }</p>\r\n                            <p>Anul publicării: { book.publicationDate } </p>\r\n                            <p>Titlul original: { book.originalTitle }</p>\r\n                            <p>Limba originală: { book.originalLanguage }</p>\r\n                            <p>Descriere: { book.description } <a href={ book.readMore }>Citeste mai mult</a></p>\r\n                            {(user ?\r\n                                <Link className={ styles.button } to={ book.download }>Download</Link>\r\n                            : null)}\r\n                                                        \r\n                            {(user ?\r\n                                <Link className={ styles.button } to={\"/books/add/\" + book.id }>Adaugă review</Link>\r\n                            : null)}\r\n                            \r\n                            {(user ?\r\n                            <>\r\n                                <Link className={ styles.button } onClick={ handleAddToFavorites }>Adaugă la favorite</Link>\r\n                                {(isSuccessfull ?\r\n                                <div className=\"alert alert-success\" role=\"alert\">\r\n                                    Modificările tale a fost salvate.\r\n                                    { redirect && <Redirect to='/profile'/> }\r\n                                </div>\r\n                                \r\n                                : null)}\r\n                            </>\r\n                            : null)}\r\n                        </div>\r\n                        <div>\r\n                            <img className={ styles.cardImg } src={ book.cover } component=\"img\" alt=\"Book Cover\"/>\r\n                        </div>\r\n                        <div className={ styles.reviews }>\r\n                            <BookReviews key={ book.id }/>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    } else {\r\n        return <h2>Loading...</h2>\r\n    }\r\n    \r\n}\r\n\r\nexport default BookDetails;"]},"metadata":{},"sourceType":"module"}