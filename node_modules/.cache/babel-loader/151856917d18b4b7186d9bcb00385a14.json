{"ast":null,"code":"import _regeneratorRuntime from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:\\\\ebooks-react-booksy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState,useContext}from'react';import{useParams,Link}from'react-router-dom';import axios from'axios';import styles from'./BookDetails.module.css';import UserContext from'../auth/UserContext';function BookReviews(){var _useParams=useParams(),bookId=_useParams.bookId;// const [book, setBook] = useState(null);\nvar setBook=useState(null);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),reviews=_useState2[0],setReviews=_useState2[1];var _useContext=useContext(UserContext),user=_useContext.user;function getReviews(_x){return _getReviews.apply(this,arguments);}function _getReviews(){_getReviews=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var promises,_yield$Promise$all,_yield$Promise$all2,book,_reviews;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;promises=[];promises.push(axios('/popularity/'+id).then(function(res){return res.data;}));promises.push(axios('/reviews?popularityId='+id).then(function(res){return res.data;}));_context.next=6;return Promise.all(promises);case 6:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);book=_yield$Promise$all2[0];_reviews=_yield$Promise$all2[1];setReviews(_reviews);setBook(book);// console.log(book, reviews);\n_context.next=17;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);console.warn(_context.t0);case 17:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return _getReviews.apply(this,arguments);}useEffect(function(){getReviews(bookId);},[bookId]);if(reviews){return/*#__PURE__*/React.createElement(\"div\",{className:\"reviews\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Reviews\"),reviews.map(function(review){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(\"h5\",null,review.user),/*#__PURE__*/React.createElement(\"h6\",null,review.date),/*#__PURE__*/React.createElement(\"p\",null,review.body),user&&user.username===review.user?/*#__PURE__*/React.createElement(Link,{className:styles.button,to:\"/books/edit/\"+review.id,key:review.id},\"Editeaza review\")// <button onClick={this.deleteReviewHandler} className={ styles.button }>Sterge review</button>\n:null);}));}}export default BookReviews;// import React, { useEffect, useState, useContext } from 'react';\n// import { useParams } from 'react-router-dom';\n// import axios from 'axios';\n// // import styles from './BookDetails.module.css';\n// import UserContext from '../auth/UserContext';\n// function Popularity() {\n//     const { bookId } = useParams();\n//     const [book, setBook] = useState(null);\n//     const [reviews, setReviews] = useState([]);\n//     const { user } = useContext(UserContext);\n//     async function getReviews(id) {\n//         try {\n//             const promises = [];\n//             promises.push(axios('/popularity/' + id).then(res => res.data));\n//             promises.push(axios('/reviews?popularityId=' + id).then(res => res.data));\n//             const [book, reviews] = await Promise.all(promises);\n//             setReviews(reviews);\n//             setBook(book);\n//             // console.log(book, reviews);\n//         } catch(e) {\n//             console.warn(e);\n//         }\n//     }\n//         useEffect(() => { \n//             getReviews(bookId); \n//         }, [bookId]);\n//         if(reviews) {\n//             return (\n//                 <div className=\"reviews\">\n//                     <h3>Reviews</h3>\n//                     {/* { reviews.map(review => <p>{ review.user }<p>{ review.body }</p></p>) } */}\n//                     { reviews.map (review => \n//                     <>\n//                     <h5>{ review.user }</h5>\n//                     <h6>{ review.date }</h6>\n//                     <p>{ review.body }</p>\n//                     </> )}\n//                     {/* {\n//                         (user?\n//                             <Link to={'./popularity/edit' + book.id} className={ styles.button}Edit this review></Link>\n//                         : null\n//                             )} */}\n//                 </div>\n//             )\n//         }\n//     }\n// export default Popularity;","map":{"version":3,"sources":["D:/ebooks-react-booksy/src/components/books/BookReviews.js"],"names":["React","useEffect","useState","useContext","useParams","Link","axios","styles","UserContext","BookReviews","bookId","setBook","reviews","setReviews","user","getReviews","id","promises","push","then","res","data","Promise","all","book","console","warn","map","review","date","body","username","button"],"mappings":"sbAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,CAAqCC,UAArC,KAAuD,OAAvD,CACA,OAASC,SAAT,CAAoBC,IAApB,KAAgC,kBAAhC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,WAAP,KAAwB,qBAAxB,CAGA,QAASC,CAAAA,WAAT,EAAuB,gBAEAL,SAAS,EAFT,CAEXM,MAFW,YAEXA,MAFW,CAGnB;AACA,GAAMC,CAAAA,OAAO,CAAGT,QAAQ,CAAC,IAAD,CAAxB,CAJmB,cAKWA,QAAQ,CAAC,EAAD,CALnB,wCAKZU,OALY,eAKHC,UALG,+BAMFV,UAAU,CAACK,WAAD,CANR,CAMXM,IANW,aAMXA,IANW,SAQJC,CAAAA,UARI,0IAQnB,iBAA0BC,EAA1B,oMAEcC,QAFd,CAEyB,EAFzB,CAGQA,QAAQ,CAACC,IAAT,CAAcZ,KAAK,CAAC,eAAiBU,EAAlB,CAAL,CAA2BG,IAA3B,CAAgC,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAR,EAAnC,CAAd,EACAJ,QAAQ,CAACC,IAAT,CAAcZ,KAAK,CAAC,yBAA2BU,EAA5B,CAAL,CAAqCG,IAArC,CAA0C,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAR,EAA7C,CAAd,EAJR,sBAMsCC,CAAAA,OAAO,CAACC,GAAR,CAAYN,QAAZ,CANtC,kGAMeO,IANf,wBAMqBZ,QANrB,wBAQQC,UAAU,CAACD,QAAD,CAAV,CACAD,OAAO,CAACa,IAAD,CAAP,CACA;AAVR,iFAaQC,OAAO,CAACC,IAAR,cAbR,qEARmB,6CAyBfzB,SAAS,CAAC,UAAM,CACZc,UAAU,CAACL,MAAD,CAAV,CACH,CAFQ,CAEN,CAACA,MAAD,CAFM,CAAT,CAIA,GAAGE,OAAH,CAAY,CACR,mBACI,2BAAK,SAAS,CAAC,SAAf,eACI,wCADJ,CAGMA,OAAO,CAACe,GAAR,CAAa,SAAAC,MAAM,qBACjB,qDACI,8BAAMA,MAAM,CAACd,IAAb,CADJ,cAEI,8BAAMc,MAAM,CAACC,IAAb,CAFJ,cAGI,6BAAKD,MAAM,CAACE,IAAZ,CAHJ,CAIMhB,IAAI,EAAIA,IAAI,CAACiB,QAAL,GAAkBH,MAAM,CAACd,IAAjC,cACE,oBAAC,IAAD,EAAM,SAAS,CAAGP,MAAM,CAACyB,MAAzB,CAAkC,EAAE,CAAE,eAAiBJ,MAAM,CAACZ,EAA9D,CAAmE,GAAG,CAAEY,MAAM,CAACZ,EAA/E,oBACA;AAFF,CAGA,IAPN,CADiB,EAAnB,CAHN,CADJ,CA2BH,CACJ,CAEL,cAAeP,CAAAA,WAAf,CAEA;AACA;AACA;AACA;AACA;AAGA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA","sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport styles from './BookDetails.module.css';\r\nimport UserContext from '../auth/UserContext';\r\n\r\n\r\nfunction BookReviews() {\r\n    \r\n    const { bookId } = useParams();\r\n    // const [book, setBook] = useState(null);\r\n    const setBook = useState(null);\r\n    const [reviews, setReviews] = useState([]);\r\n    const { user } = useContext(UserContext);\r\n\r\n    async function getReviews(id) {\r\n        try {\r\n            const promises = [];\r\n            promises.push(axios('/popularity/' + id).then(res => res.data));\r\n            promises.push(axios('/reviews?popularityId=' + id).then(res => res.data));\r\n\r\n            const [book, reviews] = await Promise.all(promises);\r\n\r\n            setReviews(reviews);\r\n            setBook(book);\r\n            // console.log(book, reviews);\r\n\r\n        } catch(e) {\r\n            console.warn(e);\r\n        }\r\n    }\r\n\r\n        useEffect(() => { \r\n            getReviews(bookId); \r\n        }, [bookId]);\r\n\r\n        if(reviews) {\r\n            return (\r\n                <div className=\"reviews\">\r\n                    <h3>Reviews</h3>\r\n                    {/* { reviews.map(review => <p>{ review.user }<p>{ review.body }</p></p>) } */}\r\n                    { reviews.map (review => (\r\n                        <>\r\n                            <h5>{ review.user }</h5>\r\n                            <h6>{ review.date }</h6>\r\n                            <p>{ review.body }</p>\r\n                            {(user && user.username === review.user ?\r\n                                <Link className={ styles.button } to={\"/books/edit/\" + review.id } key={review.id}>Editeaza review</Link>\r\n                                // <button onClick={this.deleteReviewHandler} className={ styles.button }>Sterge review</button>\r\n                            : null)}\r\n                        </> \r\n                    \r\n                   \r\n                    ))}\r\n                    \r\n                    {/* {\r\n                        (user?\r\n                            \r\n                            <Link to={\"/books/edit/\" + book.id } className={ styles.button}>Edit this review</Link>\r\n                        : null\r\n                            \r\n                            )} */}\r\n                </div>\r\n            )\r\n        }\r\n    }\r\n\r\nexport default BookReviews;\r\n\r\n// import React, { useEffect, useState, useContext } from 'react';\r\n// import { useParams } from 'react-router-dom';\r\n// import axios from 'axios';\r\n// // import styles from './BookDetails.module.css';\r\n// import UserContext from '../auth/UserContext';\r\n\r\n\r\n// function Popularity() {\r\n    \r\n//     const { bookId } = useParams();\r\n//     const [book, setBook] = useState(null);\r\n//     const [reviews, setReviews] = useState([]);\r\n//     const { user } = useContext(UserContext);\r\n\r\n//     async function getReviews(id) {\r\n//         try {\r\n//             const promises = [];\r\n//             promises.push(axios('/popularity/' + id).then(res => res.data));\r\n//             promises.push(axios('/reviews?popularityId=' + id).then(res => res.data));\r\n\r\n//             const [book, reviews] = await Promise.all(promises);\r\n\r\n//             setReviews(reviews);\r\n//             setBook(book);\r\n//             // console.log(book, reviews);\r\n\r\n//         } catch(e) {\r\n//             console.warn(e);\r\n//         }\r\n//     }\r\n\r\n//         useEffect(() => { \r\n//             getReviews(bookId); \r\n//         }, [bookId]);\r\n\r\n//         if(reviews) {\r\n//             return (\r\n//                 <div className=\"reviews\">\r\n//                     <h3>Reviews</h3>\r\n//                     {/* { reviews.map(review => <p>{ review.user }<p>{ review.body }</p></p>) } */}\r\n//                     { reviews.map (review => \r\n//                     <>\r\n//                     <h5>{ review.user }</h5>\r\n//                     <h6>{ review.date }</h6>\r\n//                     <p>{ review.body }</p>\r\n//                     </> )}\r\n                    \r\n                    \r\n//                     {/* {\r\n//                         (user?\r\n                            \r\n//                             <Link to={'./popularity/edit' + book.id} className={ styles.button}Edit this review></Link>\r\n//                         : null\r\n                            \r\n//                             )} */}\r\n//                 </div>\r\n//             )\r\n//         }\r\n//     }\r\n\r\n// export default Popularity;\r\n"]},"metadata":{},"sourceType":"module"}